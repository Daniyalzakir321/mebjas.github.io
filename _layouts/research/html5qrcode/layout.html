---
layout: default_research
---
<style>
#qr {
    width: 600px;
    height: 450px;
    border: 1px solid silver
}

@media(max-width: 600px) {
    #qr {
        width: 300px;
        height: 450px;
        border: 1px solid silver
    }
}

button:disabled,
button[disabled]{
  opacity: 0.5;
}
</style>
<div class="container" style="text-align: center">
    <h1> HTML5 QR Code scanner </h1>
    <br><br>

    <div id="qr" style="display: inline-block;"></div>
    <br><br>

    <div class="row">
        <select id="cameraSelection" disabled></select>
    </div>
    <div class="row">
        <button id="scanButton" class="btn btn-success btn-sm" disabled>start scaning</button>
        &nbsp;&nbsp;
        <button id="stopButton" class="btn btn-warning btn-sm" disabled>stop scanning</button>
    </div>
    <br><br>
    <div class="row">
        <div class="col-md-12">
            <code id="status">Click "Start Scanning" to <b>start scanning QR Code</b></code>
            <div id="feedback" style="margin: 10px; display: inline-block">
                querying for available camera options...
            </div>
            <div id="scanned-codes"></div>
            <div id="logging"></div>
        </div>
    </div>
</div>

<div class="container">
    <h2>FAQs</h2>
    <strong>Is this supported on smartphones?</strong>
    <div>Yes! the solution is based on vanilla HTML5 and javascript. This should work on any HTML5 supported browser.</div>
    <br>
    <strong>Where can I read more about this, is there a refernce article?</strong>
    <div>
        Apart from the documentation on the <a href="https://github.com/mebjas/html5-qrcode">github project</a>, following blog article may be helpful.
        <br>
        <div class="post-info" style="border: 1px solid #cfcfcf73;padding: 5px;margin: 10px 0px 0px 0px;">
            <h3 class="post-header"><a class="post-link" href="/qr-code-scanner-using-html-and-javascript/">QR Code scanner using HTML5 and Javascript</a></h3>
             <span class="post-description">
               <img src="/images/post14_image1.png" style="max-width: 50%; float: left; margin: 0px 15px 10px 0px;">
               LazarSoft had written an excellent set of <a href="https://github.com/LazarSoft/jsqrcode">QR code decoding javascript libraries</a>.
               However, it still requires some efforts to integrate the work with a web project, as we need to take care of enumerating different camera devices, setting up <code>canvas</code> or the <code>video</code> element and hooking the stream with <code>qrcode library</code>.
               Also recently, in leu of privacy concers, some javascript APIs related to accessing the camera has changed and it requires some efforts to ensure different platforms like mobile or PC, chrome or safari support it.
               To reduce these pain points I wrote a jQuery based wrapper on to abstract tasks like camera enumeration and UI setup - it can be found at <a href="https://github.com/mebjas/html5-qrcode">mebjas/html5-qrcode</a>.
               In this article I have documented some details on how to use it and what is happening under the hook.
             </span>
             <span class="read-more"><a href="/qr-code-scanner-using-html-and-javascript/">[&nbsp;Read&nbsp;more&nbsp;]</a></span>
          </div>
    </div>
</div>
<div style="display: block; height: 30px"></div>

<div class="container">
    <h2>References</h2>
    <ol>
        <li>Project on Github - <a href="https://github.com/mebjas/html5-qrcode">mebjas/html5-qrcode</a></li>
        <li>How to use - <a href="https://blog.minhazav.dev/qr-code-scanner-using-html-and-javascript/">blog.minhazav.dev</a></li>
    </ol>
</div>

<!-- Assuming JQUERY is already included -->
<script src="/assets/research/html5qrcode/jsqrcode-combined.js"></script>
<script src="/assets/research/html5qrcode/html5qrcode.js"></script>
<script>
// TODO(mebjas): Remove jQuery usage from this code.
function setFeedback(message) {
    $("#feedback").html(message);
}

function log(message) {
    $("#logging").append(`<div>${message}</div>`);
}

function setStatus(status) {
    $("#status").html(status);
}

var codesFound = 0;
var lastMessageFound = null;
const qrCodeSuccessCallback = qrCodeMessage => {
    setStatus("Pattern Found");
    setFeedback("");
    if (lastMessageFound == qrCodeMessage) {
        return;
    }
    ++codesFound;
    lastMessageFound = qrCodeMessage;
    console.log(qrCodeMessage, codesFound);
    $("#scanned-codes").prepend(`<div>[${codesFound}] New code found: <strong>${qrCodeMessage}</strong></div>`);
}

const qrCodeErrorCallback = message => {
    setStatus("Scanning");
}

const videoErrorCallback = message => {
    setFeedback(`Video Error, error = ${message}`);
}

const html5QrCode = new Html5Qrcode("qr");
Html5Qrcode.getCameras().then(cameras => {
    log(`Number of camera(s) found: ${cameras.length}`);
    if (cameras.length == 0) {
        setFeedback("Error: Zero cameras found in the device");
        return;
    }

    for (var i = 0; i < cameras.length; i++) {
        const camera = cameras[i];
        const value = camera.id;
        const name = camera.label == null ? value : camera.label;
        $("#cameraSelection").append(`<option value="${value}">${name}</option>`);
    }

    $("#cameraSelection").prop("disabled", false);
    $("#scanButton").prop("disabled", false);
    $("#scanButton").on('click', function() {
        const cameraId = $("#cameraSelection").val();
        $("#cameraSelection").prop("disabled", true);
        $("#scanButton").prop("disabled", true);
        $("#stopButton").prop("disabled", false);

        setStatus("scanning");
        setFeedback("");
        html5QrCode.start(
            cameraId, 
            {fps: 10},
            qrCodeSuccessCallback,
            qrCodeErrorCallback,
            videoErrorCallback)
            .catch(videoErrorCallback);
    });

    $("#stopButton").on('click', function() {
        html5QrCode.stop().then(ignore => {
            $("#cameraSelection").prop("disabled", false);
            $("#scanButton").prop("disabled", false);
            $("#stopButton").prop("disabled", true);

            setFeedback('Stopped');
            setFeedback("Click 'Start Scanning' to <b>start scanning QR Code</b>");
            $("#scanned-codes").html("");
        }).catch(err => {
            setFeedback('Error');
            setFeedback("Race condition, unable to close the scan.");
        });
    });
}).catch(err => {
    setFeedback(`Error: Unable to query any cameras. Reason: ${err}`);
});
</script>